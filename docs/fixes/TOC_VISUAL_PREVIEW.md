# TOC Sidebar Visual Preview

## What the User Will See After Fix

### Before Fix:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Document Viewer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âŒ No TOC button visible                â”‚  â”‚
â”‚  â”‚ âŒ No sidebar                           â”‚  â”‚
â”‚  â”‚ âŒ No section numbering                 â”‚  â”‚
â”‚  â”‚                                         â”‚  â”‚
â”‚  â”‚ [Section cards without numbers...]     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### After Fix:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Document Viewer                                               â”‚
â”‚                                                                â”‚
â”‚  ğŸ”˜ [Toggle]  â—„â”€â”€â”€ NEW: Toggle button with badge              â”‚
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ“‹ Document Map      â”‚  â”‚ #1  Preamble                 â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ #2  Article I - Name         â”‚  â”‚
â”‚  â”‚ ğŸ” [Search...]       â”‚  â”‚ #3  Article II - Purpose     â”‚  â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚ #4    Section 2.1           â”‚  â”‚
â”‚  â”‚                      â”‚  â”‚ #5    Section 2.2           â”‚  â”‚
â”‚  â”‚ #1  ğŸ“„ Preamble      â”‚  â”‚ #6  Article III - Members    â”‚  â”‚
â”‚  â”‚ #2  ğŸ“„ Article I     â”‚  â”‚ ...                          â”‚  â”‚
â”‚  â”‚ #3  ğŸ“„ Article II    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚ #4    ğŸ“„ Section 2.1 â”‚   â–²                                â”‚
â”‚  â”‚ #5    ğŸ“„ Section 2.2 â”‚   â”‚ NEW: Section number badges     â”‚
â”‚  â”‚ #6  ğŸ“„ Article III   â”‚   â”‚ (click to copy link)           â”‚
â”‚  â”‚ ...                  â”‚                                    â”‚
â”‚  â”‚                      â”‚                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚   â–²                                                           â”‚
â”‚   â”‚ NEW: Slide-out TOC sidebar                               â”‚
â”‚   â”‚ (click any section to scroll)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Layout Breakdown

### 1. Toggle Button (Left Edge)
```
ğŸ”˜ [ğŸ“‹ 42]
â”‚   â””â”€ Section count badge
â””â”€ Click to open/close sidebar
```

**Position:** Fixed to left edge of viewport
**Appearance:** Circular button with list icon
**Badge:** Shows total number of sections
**Action:** Opens/closes TOC sidebar

### 2. TOC Sidebar (Slide-out from Left)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“‹ Document Map          â”‚ â—„â”€ Header
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ 42 sections   [Collapse] â”‚ â—„â”€ Meta info
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ ğŸ” [Search sections...]  â”‚ â—„â”€ Search box
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                          â”‚
â”‚ #1  ğŸ“„ Preamble          â”‚ â—„â”€ Root section
â”‚ #2  ğŸ“„ Article I         â”‚ â—„â”€ Root section
â”‚ #3  ğŸ“„ Article II        â”‚ â—„â”€ Root section
â”‚ #4    ğŸ“„ Section 2.1     â”‚ â—„â”€ Indented (depth 1)
â”‚ #5      ğŸ“„ Subsec 2.1.1  â”‚ â—„â”€ More indented (depth 2)
â”‚ #6    ğŸ“„ Section 2.2  ğŸ”’ â”‚ â—„â”€ Locked badge
â”‚ #7    ğŸ“„ Section 2.3  3ğŸ’¬â”‚ â—„â”€ Suggestion count
â”‚ ...                      â”‚
â”‚                          â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ Structure Overview       â”‚ â—„â”€ Depth summary
â”‚ [Articles: 5] [Sects: 12]â”‚
â”‚ [Subsects: 25]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Width:** ~280px (responsive)
**Animation:** Slides in/out smoothly
**Background:** White with subtle shadow
**Scroll:** Independent scroll (sticky header)

### 3. Section Number Badges (On Section Cards)
```
Section Card:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  #1  Preamble                    [Edit]â”‚
â”‚  â””â”€ Blue numbered badge                â”‚
â”‚                                         â”‚
â”‚  Original Text: ...                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â–²
       â”‚ Click badge to copy anchor link
       â”‚ Tooltip: "Section 1 - Click to copy link"
```

**Appearance:** Blue gradient badge with white # symbol
**Position:** Left side of section header
**Tooltip:** Shows on hover
**Action:** Click to copy anchor link to clipboard
**Feedback:** Badge flashes green on copy success

## Depth Visualization (Indentation)

```
TOC Indentation by Depth:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Depth 0 (Root):
#1  ğŸ“„ Preamble

Depth 1 (1 indent):
#2    ğŸ“„ Article I

Depth 2 (2 indents):
#3      ğŸ“„ Section 1.1

Depth 3 (3 indents):
#4        ğŸ“„ Subsection 1.1.1

Depth 4+ (4+ indents):
#5          ğŸ“„ Clause 1.1.1.1
```

**Visual Hierarchy:**
- Depth 0: No indentation, bold
- Depth 1: 20px indent, medium weight
- Depth 2: 40px indent, normal weight
- Depth 3+: 60px+ indent, lighter weight

## Interactive Features

### Search (Real-time Filtering)
```
Before search:
#1  Preamble
#2  Article I
#3  Article II
#4  Section 2.1
#5  Section 2.2

User types "2.1" â†’

After search:
#4  Section 2.1        â—„â”€ Match highlighted
#5  Section 2.1.1      â—„â”€ Match highlighted
```

### Active Section Highlighting
```
As user scrolls document:

TOC automatically highlights current section:
#1  Preamble
#2  Article I        â—„â”€ âœ¨ Highlighted (user is here)
#3  Article II
```

**Highlight Color:** Blue background with border
**Scroll Behavior:** TOC scrolls to keep active section visible

### Click to Scroll
```
User clicks "#5 Section 2.2" in TOC
         â†“
Page smoothly scrolls to that section
         â†“
Section card flashes yellow briefly
         â†“
Section auto-expands if collapsed
         â†“
TOC closes on mobile (stays open on desktop)
```

## Mobile Responsive Behavior

### Desktop (> 768px)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”˜ [TOC]  [Document content...]     â”‚
â”‚            â–²                         â”‚
â”‚            â”‚ Toggle stays visible    â”‚
â”‚            â”‚ Sidebar overlays        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mobile (< 768px)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”˜ [TOC hidden]       â”‚
â”‚                       â”‚
â”‚ [Document content]    â”‚
â”‚ ...                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tap toggle â†’

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [TOC slides over      â”‚
â”‚  and covers content]  â”‚
â”‚                       â”‚
â”‚ #1  Preamble          â”‚
â”‚ #2  Article I         â”‚
â”‚ ...                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Tap section or backdrop â†’

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [TOC slides away]     â”‚
â”‚                       â”‚
â”‚ [Document content]    â”‚
â”‚ ...                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Keyboard Navigation

### Shortcuts
```
Ctrl/Cmd + K  â†’  Toggle TOC open/close
Escape        â†’  Close TOC (if open)
Arrow Up      â†’  Previous TOC item (when TOC focused)
Arrow Down    â†’  Next TOC item (when TOC focused)
Enter/Space   â†’  Jump to selected section
Tab           â†’  Navigate focusable elements
```

### Focus Management
```
1. User presses Ctrl+K
   â””â”€> TOC opens and search box gets focus

2. User types to search
   â””â”€> List filters in real-time

3. User presses Tab
   â””â”€> Focus moves to first TOC item

4. User presses Arrow Down
   â””â”€> Focus moves to next TOC item

5. User presses Enter
   â””â”€> Page scrolls to that section
       â””â”€> Focus moves to section card
```

## Color Scheme

```
Toggle Button:
- Background: #2563eb (blue)
- Hover: #1d4ed8 (darker blue)
- Badge: #ef4444 (red) with white text

Sidebar:
- Background: #ffffff (white)
- Border: #e5e7eb (light gray)
- Shadow: rgba(0,0,0,0.1)

Section Number Badges:
- Background: Linear gradient #2563eb â†’ #1d4ed8 (blue)
- Text: #ffffff (white)
- Hover: Darker gradient + shadow
- Copied: Flash green (#10b981)

TOC Items:
- Default: #1f2937 (dark gray text)
- Hover: #eff6ff (light blue background)
- Active: #dbeafe (blue background) + #2563eb (blue border)
- Depth colors: Gradient from dark to light

Badges in TOC:
- Locked: #dc2626 (red) with lock icon
- Suggestions: #f59e0b (amber) with count
```

## Animations

### Sidebar Slide
```
Open:  transform: translateX(0)      [300ms ease-out]
Close: transform: translateX(-100%)  [250ms ease-in]
```

### Section Flash
```
Click section in TOC:
  background: white â†’ #fef3c7 (yellow) â†’ white  [1000ms]
```

### Badge Copy
```
Click number badge:
  background: blue â†’ #10b981 (green) â†’ blue  [2000ms]
  content: "#1" â†’ "âœ“" â†’ "#1"  [2000ms]
```

### Hover Effects
```
TOC items:     scale(1.02)  [200ms ease]
Number badges: translateY(-1px) + shadow  [200ms ease]
Toggle button: scale(1.1)  [200ms ease]
```

## Accessibility Features

```
ARIA Labels:
- Toggle button: "Toggle table of contents" / "aria-expanded"
- TOC nav: "Table of Contents" / role="navigation"
- TOC items: "Jump to section X: [title]" / role="link"
- Number badges: "Section number X. Click to copy permanent link."

Screen Reader Announcements:
- "Table of contents opened"
- "Table of contents closed"
- "Link copied to clipboard"
- "Navigated to section [title]"
- "Showing [N] of [total] sections" (when searching)

Keyboard Focus:
- Visible focus rings on all interactive elements
- Logical tab order
- Trapped focus in TOC when open (Escape to exit)
- Skip to content link at top
```

## Browser Compatibility

```
âœ… Chrome/Edge (Chromium):  Full support
âœ… Firefox:                 Full support
âœ… Safari:                  Full support
âœ… Mobile Safari:           Full support
âœ… Chrome Mobile:           Full support

Fallback Features:
- Clipboard API: Falls back to execCommand if not supported
- Intersection Observer: Graceful degradation (no auto-highlight)
- Smooth scroll: Falls back to instant scroll
- CSS Grid/Flexbox: Required (IE11 not supported)
```

---

## Summary

The TOC sidebar provides:
- **Visual navigation** through numbered sections
- **Quick access** via searchable list
- **Contextual awareness** with active section highlighting
- **Accessibility** with full keyboard and screen reader support
- **Mobile-friendly** responsive design
- **Professional appearance** with smooth animations

**User Experience:** Clean, intuitive, fast, and accessible.

**Implementation:** Already complete, just needed to be loaded!
