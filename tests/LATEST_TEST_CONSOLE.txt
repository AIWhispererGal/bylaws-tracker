[SETUP-DEBUG] üîî Triggering async processSetupData via setImmediate
[SETUP-DEBUG] üìä Current session setupData: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403833-157999187.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  }
}
[SETUP-DEBUG] üèÉ setImmediate callback executing...
[SETUP-DEBUG] üöÄ START processSetupData()
[SETUP-DEBUG] üìä Initial setupData: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403833-157999187.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  }
}
[SETUP-DEBUG] üìä Initial completedSteps: [ 'organization', 'document', 'workflow', 'import' ]
[SETUP-DEBUG] üìù Steps to process: [
  'organization',
  'document',
  'workflow',
  'import',
  'database',
  'finalize'
]
[SETUP-DEBUG] ‚è≥ BEFORE step 1/6: "organization"
[SETUP-DEBUG] üìä completedSteps before step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è±Ô∏è  Starting 1-second delay for step: "organization"
[SETUP-DEBUG] üîî Triggering async processSetupData via setImmediate
[SETUP-DEBUG] üìä Current session setupData: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403886-185809539.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  }
}
[SETUP-DEBUG] üèÉ setImmediate callback executing...
[SETUP-DEBUG] üöÄ START processSetupData()
[SETUP-DEBUG] üìä Initial setupData: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403886-185809539.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  }
}
[SETUP-DEBUG] üìä Initial completedSteps: [ 'organization', 'document', 'workflow', 'import' ]
[SETUP-DEBUG] üìù Steps to process: [
  'organization',
  'document',
  'workflow',
  'import',
  'database',
  'finalize'
]
[SETUP-DEBUG] ‚è≥ BEFORE step 1/6: "organization"
[SETUP-DEBUG] üìä completedSteps before step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è±Ô∏è  Starting 1-second delay for step: "organization"
[SETUP-DEBUG] üì° /setup/status endpoint called
[SETUP-DEBUG] üìä setupData from session: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403886-185809539.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  }
}
[SETUP-DEBUG] üìä completedSteps: [ 'organization', 'document', 'workflow', 'import' ]
[SETUP-DEBUG] üìä status: processing
[SETUP-DEBUG] üìä progressPercentage: 66.66666666666666
[SETUP-DEBUG] üìä currentStep: database
[SETUP-DEBUG] üìä estimatedSeconds: 10
[SETUP-DEBUG] üì§ Sending response: {
  "status": "processing",
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "currentStep": "database",
  "progressPercentage": 67,
  "estimatedSeconds": 10,
  "totalSteps": 6,
  "error": null,
  "errorDetails": null
}
[SETUP-DEBUG] ‚úÖ Delay completed for step: "organization"
[SETUP-DEBUG] ‚è≠Ô∏è  Step "organization" already in completedSteps, skipping add
[SETUP-DEBUG] üîß Processing step logic: "organization"
[SETUP-DEBUG] üè¢ Processing organization step
[SETUP-DEBUG] üìã orgData: {
  "organization_name": "Another Test Org",
  "organization_type": "other",
  "state": "CA",
  "country": "USA",
  "contact_email": "mgallagh@gmail.com",
  "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
}
[SETUP-DEBUG] ‚úÖ orgData exists, creating organization...
[SETUP-DEBUG] üîó Generated slug: another-test-org-mgmw5w9p
[SETUP-DEBUG] üíæ Inserting into Supabase organizations table...
[SETUP-DEBUG] ‚úÖ Delay completed for step: "organization"
[SETUP-DEBUG] ‚è≠Ô∏è  Step "organization" already in completedSteps, skipping add
[SETUP-DEBUG] üîß Processing step logic: "organization"
[SETUP-DEBUG] üè¢ Processing organization step
[SETUP-DEBUG] üìã orgData: {
  "organization_name": "Another Test Org",
  "organization_type": "other",
  "state": "CA",
  "country": "USA",
  "contact_email": "mgallagh@gmail.com",
  "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
}
[SETUP-DEBUG] ‚úÖ orgData exists, creating organization...
[SETUP-DEBUG] üîó Generated slug: another-test-org-mgmw5w9u
[SETUP-DEBUG] üíæ Inserting into Supabase organizations table...
[SETUP-DEBUG] ‚úÖ Organization created with ID: 4d742c8c-46e0-4f0f-adc7-e3a28d30f96e
[SETUP-DEBUG] ‚úÖ AFTER step 1/6: "organization" completed
[SETUP-DEBUG] üìä completedSteps after step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è≥ BEFORE step 2/6: "document"
[SETUP-DEBUG] üìä completedSteps before step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è±Ô∏è  Starting 1-second delay for step: "document"
[SETUP-DEBUG] ‚úÖ Organization created with ID: 31998621-8461-4bc6-aeb9-6f9e50b7517e
[SETUP-DEBUG] ‚úÖ AFTER step 1/6: "organization" completed
[SETUP-DEBUG] üìä completedSteps after step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è≥ BEFORE step 2/6: "document"
[SETUP-DEBUG] üìä completedSteps before step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è±Ô∏è  Starting 1-second delay for step: "document"
[SETUP-DEBUG] ‚úÖ Delay completed for step: "document"
[SETUP-DEBUG] ‚è≠Ô∏è  Step "document" already in completedSteps, skipping add
[SETUP-DEBUG] üîß Processing step logic: "document"
[SETUP-DEBUG] üìÑ Processing document step (no-op)
[SETUP-DEBUG] ‚úÖ AFTER step 2/6: "document" completed
[SETUP-DEBUG] üìä completedSteps after step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è≥ BEFORE step 3/6: "workflow"
[SETUP-DEBUG] üìä completedSteps before step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è±Ô∏è  Starting 1-second delay for step: "workflow"
[SETUP-DEBUG] ‚úÖ Delay completed for step: "document"
[SETUP-DEBUG] ‚è≠Ô∏è  Step "document" already in completedSteps, skipping add
[SETUP-DEBUG] üîß Processing step logic: "document"
[SETUP-DEBUG] üìÑ Processing document step (no-op)
[SETUP-DEBUG] ‚úÖ AFTER step 2/6: "document" completed
[SETUP-DEBUG] üìä completedSteps after step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è≥ BEFORE step 3/6: "workflow"
[SETUP-DEBUG] üìä completedSteps before step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è±Ô∏è  Starting 1-second delay for step: "workflow"
[SETUP-DEBUG] üì° /setup/status endpoint called
[SETUP-DEBUG] üìä setupData from session: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403886-185809539.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  }
}
[SETUP-DEBUG] üìä completedSteps: [ 'organization', 'document', 'workflow', 'import' ]
[SETUP-DEBUG] üìä status: processing
[SETUP-DEBUG] üìä progressPercentage: 66.66666666666666
[SETUP-DEBUG] üìä currentStep: database
[SETUP-DEBUG] üìä estimatedSeconds: 10
[SETUP-DEBUG] üì§ Sending response: {
  "status": "processing",
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "currentStep": "database",
  "progressPercentage": 67,
  "estimatedSeconds": 10,
  "totalSteps": 6,
  "error": null,
  "errorDetails": null
}
[SETUP-DEBUG] ‚úÖ Delay completed for step: "workflow"
[SETUP-DEBUG] ‚è≠Ô∏è  Step "workflow" already in completedSteps, skipping add
[SETUP-DEBUG] üîß Processing step logic: "workflow"
[SETUP-DEBUG] üîÑ Processing workflow step (no-op)
[SETUP-DEBUG] ‚úÖ AFTER step 3/6: "workflow" completed
[SETUP-DEBUG] üìä completedSteps after step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è≥ BEFORE step 4/6: "import"
[SETUP-DEBUG] üìä completedSteps before step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è±Ô∏è  Starting 1-second delay for step: "import"
[SETUP-DEBUG] ‚úÖ Delay completed for step: "workflow"
[SETUP-DEBUG] ‚è≠Ô∏è  Step "workflow" already in completedSteps, skipping add
[SETUP-DEBUG] üîß Processing step logic: "workflow"
[SETUP-DEBUG] üîÑ Processing workflow step (no-op)
[SETUP-DEBUG] ‚úÖ AFTER step 3/6: "workflow" completed
[SETUP-DEBUG] üìä completedSteps after step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è≥ BEFORE step 4/6: "import"
[SETUP-DEBUG] üìä completedSteps before step: [organization, document, workflow, import]
[SETUP-DEBUG] ‚è±Ô∏è  Starting 1-second delay for step: "import"
[SETUP-DEBUG] ‚úÖ Delay completed for step: "import"
[SETUP-DEBUG] ‚è≠Ô∏è  Step "import" already in completedSteps, skipping add
[SETUP-DEBUG] üîß Processing step logic: "import"
[SETUP-DEBUG] üì• Processing import step
[SETUP-DEBUG] üìÑ Processing uploaded file: /mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403833-157999187.docx
[SETUP-DEBUG] üîÑ Calling setupService.processDocumentImport...
[SETUP-DEBUG] ‚úÖ Delay completed for step: "import"
[SETUP-DEBUG] ‚è≠Ô∏è  Step "import" already in completedSteps, skipping add
[SETUP-DEBUG] üîß Processing step logic: "import"
[SETUP-DEBUG] üì• Processing import step
[SETUP-DEBUG] üìÑ Processing uploaded file: /mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403886-185809539.docx
[SETUP-DEBUG] üîÑ Calling setupService.processDocumentImport...
[SETUP-DEBUG] üì° /setup/status endpoint called
[SETUP-DEBUG] üìä setupData from session: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403886-185809539.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  }
}
[SETUP-DEBUG] üìä completedSteps: [ 'organization', 'document', 'workflow', 'import' ]
[SETUP-DEBUG] üìä status: processing
[SETUP-DEBUG] üìä progressPercentage: 66.66666666666666
[SETUP-DEBUG] üìä currentStep: database
[SETUP-DEBUG] üìä estimatedSeconds: 10
[SETUP-DEBUG] üì§ Sending response: {
  "status": "processing",
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "currentStep": "database",
  "progressPercentage": 67,
  "estimatedSeconds": 10,
  "totalSteps": 6,
  "error": null,
  "errorDetails": null
}
[SETUP-DEBUG] üì° /setup/status endpoint called
[SETUP-DEBUG] üìä setupData from session: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403886-185809539.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  }
}
[SETUP-DEBUG] üìä completedSteps: [ 'organization', 'document', 'workflow', 'import' ]
[SETUP-DEBUG] üìä status: processing
[SETUP-DEBUG] üìä progressPercentage: 66.66666666666666
[SETUP-DEBUG] üìä currentStep: database
[SETUP-DEBUG] üìä estimatedSeconds: 10
[SETUP-DEBUG] üì§ Sending response: {
  "status": "processing",
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "currentStep": "database",
  "progressPercentage": 67,
  "estimatedSeconds": 10,
  "totalSteps": 6,
  "error": null,
  "errorDetails": null
}
[WordParser] Detected TOC: lines 30-128 (50 lines matched pattern)
[WordParser] Filtered 47 TOC items, kept 60 real headers
[WordParser] Scanning for orphaned content...
[WordParser] Detected TOC: lines 30-128 (50 lines matched pattern)
[WordParser] Found 3 orphaned content block(s)
[WordParser] Orphan details: [
  { lines: '18-18', preview: 'BYLAWS OF THE...' },
  {
    lines: '22-22',
    preview: 'RESEDA NEIGHBORHOOD COUNCIL May 17, 2024...'
  },
  { lines: '24-24', preview: 'Table of Contents...' }
]
[WordParser] Created preamble section for orphan at lines 18-18
[WordParser] Attached orphan (lines 22-22) to section: Preamble
[WordParser] Attached orphan (lines 24-24) to section: Preamble
[WordParser] Checking for duplicate sections...
[WordParser] Skipping duplicate Section1 (keeping original with 742 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 1047 chars)
[WordParser] Replacing duplicate Section1 (742 ‚Üí 1928 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 1047 chars)
[WordParser] Skipping duplicate Section3 (keeping original with 485 chars)
[WordParser] Skipping duplicate Section1 (keeping original with 1928 chars)
[WordParser] Replacing duplicate Section2 (1047 ‚Üí 4913 chars)
[WordParser] Replacing duplicate Section3 (485 ‚Üí 1593 chars)
[WordParser] Skipping duplicate Section4 (keeping original with 466 chars)
[WordParser] Replacing duplicate Section1 (1928 ‚Üí 6108 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 4913 chars)
[WordParser] Replacing duplicate Section3 (1593 ‚Üí 2649 chars)
[WordParser] Skipping duplicate Section1 (keeping original with 6108 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 4913 chars)
[WordParser] Skipping duplicate Section3 (keeping original with 2649 chars)
[WordParser] Replacing duplicate Section4 (466 ‚Üí 1985 chars)
[WordParser] Skipping duplicate Section1 (keeping original with 6108 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 4913 chars)
[WordParser] Skipping duplicate Section3 (keeping original with 2649 chars)
[WordParser] Skipping duplicate Section4 (keeping original with 1985 chars)
[WordParser] Skipping duplicate Section5 (keeping original with 903 chars)
[WordParser] Skipping duplicate Section6 (keeping original with 4765 chars)
[WordParser] Skipping duplicate Section1 (keeping original with 6108 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 4913 chars)
[WordParser] Skipping duplicate Section3 (keeping original with 2649 chars)
[WordParser] ‚ö†Ô∏è  Removed 25 duplicate sections
[WordParser] Note: Source document contains duplicate content (e.g., table of contents + body)
[WordParser] Deduplicated citations: Section1, Section2, Section3, Section4, Section5, Section6
[WordParser] Detected TOC: lines 30-128 (50 lines matched pattern)
[WordParser] Filtered 47 TOC items, kept 60 real headers
[WordParser] Scanning for orphaned content...
[WordParser] Detected TOC: lines 30-128 (50 lines matched pattern)
[WordParser] Found 3 orphaned content block(s)
[WordParser] Orphan details: [
  { lines: '18-18', preview: 'BYLAWS OF THE...' },
  {
    lines: '22-22',
    preview: 'RESEDA NEIGHBORHOOD COUNCIL May 17, 2024...'
  },
  { lines: '24-24', preview: 'Table of Contents...' }
]
[WordParser] Created preamble section for orphan at lines 18-18
[WordParser] Attached orphan (lines 22-22) to section: Preamble
[WordParser] Attached orphan (lines 24-24) to section: Preamble
[WordParser] Checking for duplicate sections...
[WordParser] Skipping duplicate Section1 (keeping original with 742 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 1047 chars)
[WordParser] Replacing duplicate Section1 (742 ‚Üí 1928 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 1047 chars)
[WordParser] Skipping duplicate Section3 (keeping original with 485 chars)
[WordParser] Skipping duplicate Section1 (keeping original with 1928 chars)
[WordParser] Replacing duplicate Section2 (1047 ‚Üí 4913 chars)
[WordParser] Replacing duplicate Section3 (485 ‚Üí 1593 chars)
[WordParser] Skipping duplicate Section4 (keeping original with 466 chars)
[WordParser] Replacing duplicate Section1 (1928 ‚Üí 6108 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 4913 chars)
[WordParser] Replacing duplicate Section3 (1593 ‚Üí 2649 chars)
[WordParser] Skipping duplicate Section1 (keeping original with 6108 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 4913 chars)
[WordParser] Skipping duplicate Section3 (keeping original with 2649 chars)
[WordParser] Replacing duplicate Section4 (466 ‚Üí 1985 chars)
[WordParser] Skipping duplicate Section1 (keeping original with 6108 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 4913 chars)
[WordParser] Skipping duplicate Section3 (keeping original with 2649 chars)
[WordParser] Skipping duplicate Section4 (keeping original with 1985 chars)
[WordParser] Skipping duplicate Section5 (keeping original with 903 chars)
[WordParser] Skipping duplicate Section6 (keeping original with 4765 chars)
[WordParser] Skipping duplicate Section1 (keeping original with 6108 chars)
[WordParser] Skipping duplicate Section2 (keeping original with 4913 chars)
[WordParser] Skipping duplicate Section3 (keeping original with 2649 chars)
[WordParser] ‚ö†Ô∏è  Removed 25 duplicate sections
[WordParser] Note: Source document contains duplicate content (e.g., table of contents + body)
[WordParser] Deduplicated citations: Section1, Section2, Section3, Section4, Section5, Section6
[SETUP-DEBUG] ‚ùå Import failed: Document validation failed
[SETUP-DEBUG] ‚ùå Validation errors: [
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Preamble"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleI"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section1"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section2"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section3"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleIII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleIV"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleV"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section4"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section5"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section6"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section7"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section8"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section9"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section10"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section11"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleVI"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleVII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleVIII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleIX"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleX"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleXI"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleXII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleXIII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleXIV"
  }
]
[SETUP-DEBUG] ‚ö†Ô∏è  Validation warnings: [
  {
    "type": "warning",
    "message": "2 sections have no content",
    "sections": [
      "ArticleVI",
      "ArticleX"
    ]
  }
]
[SETUP-DEBUG] ‚ùå Parse error: Error: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:562:39)
[SETUP-DEBUG] ‚ùå Stack trace: Error: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:562:39)
[SETUP-DEBUG] ‚ùå ERROR in step "import": Error: Failed to parse document: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)
[SETUP-DEBUG] ‚ùå Error stack: Error: Failed to parse document: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)
[SETUP-DEBUG] ‚ùå Error details: {}
[SETUP-DEBUG] ‚ùå Import failed: Document validation failed
[SETUP-DEBUG] ‚ùå Validation errors: [
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Preamble"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleI"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section1"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section2"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section3"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleIII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleIV"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleV"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section4"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section5"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section6"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section7"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section8"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section9"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section10"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "Section11"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleVI"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleVII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleVIII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleIX"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleX"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleXI"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleXII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleXIII"
  },
  {
    "type": "error",
    "message": "No level definition found for depth 0",
    "section": "ArticleXIV"
  }
]
[SETUP-DEBUG] ‚ö†Ô∏è  Validation warnings: [
  {
    "type": "warning",
    "message": "2 sections have no content",
    "sections": [
      "ArticleVI",
      "ArticleX"
    ]
  }
]
[SETUP-DEBUG] ‚ùå Parse error: Error: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:562:39)
[SETUP-DEBUG] ‚ùå Stack trace: Error: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:562:39)
[SETUP-DEBUG] ‚ùå ERROR in step "import": Error: Failed to parse document: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)
[SETUP-DEBUG] ‚ùå Error stack: Error: Failed to parse document: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)
[SETUP-DEBUG] ‚ùå Error details: {}
[SETUP-DEBUG] ‚ùå Setup processing error: Error: Failed to parse document: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)
[SETUP-DEBUG] ‚ùå Error stack: Error: Failed to parse document: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)
[SETUP-DEBUG] ‚ùå Set status to "error"
[SETUP-DEBUG] ‚ùå Setup processing error: Error: Failed to parse document: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)
[SETUP-DEBUG] ‚ùå Error stack: Error: Failed to parse document: Failed to import document: Document validation failed
    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)
[SETUP-DEBUG] ‚ùå Set status to "error"
[SETUP-DEBUG] ‚ùå Error session saved
[SETUP-DEBUG] ‚ùå Error session saved
[SETUP-DEBUG] üì° /setup/status endpoint called
[SETUP-DEBUG] üìä setupData from session: {
  "organization": {
    "organization_name": "Another Test Org",
    "organization_type": "other",
    "state": "CA",
    "country": "USA",
    "contact_email": "mgallagh@gmail.com",
    "logo_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224365216-393931973.png"
  },
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "documentType": {
    "structure_type": "article-section",
    "level1_name": "Article",
    "level2_name": "Section",
    "numbering_style": "roman"
  },
  "workflow": {
    "template": "committee",
    "stages": [
      {
        "name": "Committee Review",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      },
      {
        "name": "Board Approval",
        "approvalType": "majority",
        "approvers": [],
        "skipIfAuthor": false
      }
    ],
    "notifications": {
      "onSubmit": true,
      "onApproval": true,
      "onRejection": true,
      "onComplete": true
    }
  },
  "import": {
    "source": "file_upload",
    "file_path": "/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/uploads/setup/setup-1760224403833-157999187.docx",
    "file_name": "RNCBYLAWS_2024.docx",
    "auto_detect_structure": true,
    "preserve_formatting": false,
    "create_initial_version": true
  },
  "organizationId": "4d742c8c-46e0-4f0f-adc7-e3a28d30f96e",
  "status": "error",
  "error": "Failed to parse document: Failed to import document: Document validation failed",
  "errorDetails": "Error: Failed to parse document: Failed to import document: Document validation failed\n    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)"
}
[SETUP-DEBUG] üìä completedSteps: [ 'organization', 'document', 'workflow', 'import' ]
[SETUP-DEBUG] üìä status: error
[SETUP-DEBUG] üìä progressPercentage: 66.66666666666666
[SETUP-DEBUG] üìä currentStep: database
[SETUP-DEBUG] üìä estimatedSeconds: 10
[SETUP-DEBUG] üì§ Sending response: {
  "status": "error",
  "completedSteps": [
    "organization",
    "document",
    "workflow",
    "import"
  ],
  "currentStep": "database",
  "progressPercentage": 67,
  "estimatedSeconds": 10,
  "totalSteps": 6,
  "error": "Failed to parse document: Failed to import document: Document validation failed",
  "errorDetails": "Error: Failed to parse document: Failed to import document: Document validation failed\n    at processSetupData (/mnt/c/Users/mgall/OneDrive/Desktop/BYLAWSCOMMITTEE/BYLAWSTOOL_Generalized/src/routes/setup.js:567:35)"
}



